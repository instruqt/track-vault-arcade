id: l3ddywkqnj
type: track
version: 0.0.1
slug: vault-arcade
icon: https://storage.googleapis.com/instruqt-frontend/img/tracks/vault.png
title: Vault arcade
teaser: Are you the Master of Secrets?
description: Vault arcade track.
tags: []
challenges:
- id: gvyybozeag
  slug: unseal
  title: Unseal
  teaser: Initialize Vault and unseal Vault
  notes:
  - type: text
    contents: https://www.vaultproject.io/intro/getting-started/deploy.html
  difficulty: basic
  assignment: |-
    Vault is running on http://localhost:8200.
    Initialize it with *1 key share* and a *threshold of 1*.

    Then unseal it and log in with the *root token*.
  timelimit: 300
  tabs:
  - type: terminal
    title: Shell
    hostname: vault
- id: kozzd8v66g
  slug: store-a-secret
  title: Write a secret
  teaser: Write a secret to Vault
  notes:
  - type: text
    contents: https://www.vaultproject.io/docs/commands/write.html
  difficulty: basic
  assignment: |-
    Write a secret to Vault on the path *secret/highscore*.

    The secret should contain *user=mrrobot* and *score=10000*.
  timelimit: 300
  tabs:
  - type: terminal
    title: Shell
    hostname: vault
- id: gx33bnle2g
  slug: read-a-secret
  title: Read a secret
  teaser: Read a secret from Vault
  notes:
  - type: text
    contents: https://www.vaultproject.io/docs/commands/read.html
  difficulty: basic
  assignment: Read the secret from the previous challenge, located at the path *secret/highscore*.
  timelimit: 300
  tabs:
  - type: terminal
    title: Shell
    hostname: vault
- id: gd448ym5ng
  slug: mount-a-backend
  title: Mount a backend
  teaser: Mount a secret backend
  notes:
  - type: text
    contents: https://www.vaultproject.io/docs/secrets/databases/index.html
  difficulty: basic
  assignment: "Mount the database secrets backend. \nThen configure the *postgres*
    role to use the PostgreSQL server, with the connection_url *postgresql://postgres:notsecure@postgres:5432/?sslmode=disable*.\n\nThe
    allowed_roles should be *postgres* and the *plugin_name=postgres-database-plugin*."
  timelimit: 300
  tabs:
  - type: terminal
    title: Shell
    hostname: vault
- id: gw33b8aelk
  slug: generate-credentials
  title: Generate dynamic credentials
  teaser: Generate dynamic postgres credentials
  notes:
  - type: text
    contents: https://www.vaultproject.io/docs/secrets/databases/postgresql.html
  difficulty: basic
  assignment: |-
    Configure the *postgres* role so that it can create database credentials with the following SQL statements.

    CREATE ROLE \"{{name}}\" WITH LOGIN PASSWORD '{{password}}' VALID UNTIL '{{expiration}}'; \
    GRANT SELECT ON ALL TABLES IN SCHEMA public TO \"{{name}}\";

    You can test the configuration by reading from the *database/creds/postgres* endpoint.
  timelimit: 300
  tabs:
  - type: terminal
    title: Shell
    hostname: vault
- id: 7q66oz9e6g
  slug: one-time-passwords
  title: One time passwords
  teaser: Configure Vault as TOTP provider
  notes:
  - type: text
    contents: https://www.vaultproject.io/docs/secrets/totp/index.html
  difficulty: basic
  assignment: |-
    Enable the TOTP secrets engine and configure Vault to be a *TOTP provider* on the path *totp/keys/mrrobot*.

    The issuer should be *Vault* and the account_name should be *mrrobot@instruqt.com*.
  timelimit: 300
  tabs:
  - type: terminal
    title: Shell
    hostname: vault
- id: 7raab4xewg
  slug: generate-totp
  title: Generate TOTP
  teaser: Generate one-time passwords
  notes:
  - type: text
  difficulty: basic
  assignment: |-
    Configure the previously configured Vault TOTP provider as a TOTP code generator.

    For convenience we set the TOTP_SECRET environment variable to the Vault TOTP secret url.
  timelimit: 300
  tabs:
  - type: terminal
    title: Shell
    hostname: vault
developers:
- erik@instruqt.com
- jackson.nic@gmail.com
published: false
